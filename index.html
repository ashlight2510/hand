<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Primary Meta Tags -->
    <title>ì†ë°”ë‹¥ ì° í‘¼ë‹¤ - ì‚¬ì§„ í•œ ì¥ìœ¼ë¡œ ë³´ëŠ” ì†ê¸ˆ ì„±í–¥ ë¶„ì„</title>
    <meta
      name="title"
      content="ì†ë°”ë‹¥ ì° í‘¼ë‹¤ - ì‚¬ì§„ í•œ ì¥ìœ¼ë¡œ ë³´ëŠ” ì†ê¸ˆ ì„±í–¥ ë¶„ì„"
    />
    <meta
      name="description"
      content="ì†ë°”ë‹¥ ì‚¬ì§„ë§Œ ì˜¬ë¦¬ë©´ 3ì´ˆ ë§Œì— ì†ê¸ˆ ì„±í–¥ì„ ë¶„ì„í•´ì£¼ëŠ” ë¬´ë£Œ ì›¹ í…ŒìŠ¤íŠ¸. ì§€ëŠ¥ì„ , ê°ì •ì„ , ìƒëª…ì„ ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹¹ì‹ ì˜ ì„±í–¥ì„ ì¹´ë“œë¡œ ì „ë‹¬í•©ë‹ˆë‹¤. ì„œë²„ ì—†ì´ ë¸Œë¼ìš°ì €ì—ì„œ ì¦‰ì‹œ ì‘ë™í•©ë‹ˆë‹¤."
    />
    <meta
      name="keywords"
      content="ì†ê¸ˆ, ì†ê¸ˆë³´ê¸°, ì†ê¸ˆ ë¶„ì„, ì†ê¸ˆ í…ŒìŠ¤íŠ¸, ì†ë°”ë‹¥, ì§€ëŠ¥ì„ , ê°ì •ì„ , ìƒëª…ì„ , ì†ê¸ˆ ì„±í–¥, palm reading, palmistry, ì†ê¸ˆ ìŠ¤ìºë„ˆ"
    />
    <meta name="author" content="ì†ë°”ë‹¥ ì° í‘¼ë‹¤" />
    <meta name="robots" content="index, follow" />
    <meta name="language" content="Korean" />
    <meta name="revisit-after" content="7 days" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://hand.funnyfunny.cloud/" />
    <meta
      property="og:title"
      content="ì†ë°”ë‹¥ ì° í‘¼ë‹¤ - ì‚¬ì§„ í•œ ì¥ìœ¼ë¡œ ë³´ëŠ” ì†ê¸ˆ ì„±í–¥ ë¶„ì„"
    />
    <meta
      property="og:description"
      content="ì†ë°”ë‹¥ ì‚¬ì§„ë§Œ ì˜¬ë¦¬ë©´ 3ì´ˆ ë§Œì— ì†ê¸ˆ ì„±í–¥ì„ ë¶„ì„í•´ì£¼ëŠ” ë¬´ë£Œ ì›¹ í…ŒìŠ¤íŠ¸. ì§€ëŠ¥ì„ , ê°ì •ì„ , ìƒëª…ì„ ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹¹ì‹ ì˜ ì„±í–¥ì„ ì¹´ë“œë¡œ ì „ë‹¬í•©ë‹ˆë‹¤."
    />
    <meta
      property="og:image"
      content="https://dummyimage.com/1200x630/0f172a/ffffff&amp;text=Hand+Gold"
    />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="ì†ë°”ë‹¥ ì° í‘¼ë‹¤" />
    <meta property="og:site_name" content="ì†ë°”ë‹¥ ì° í‘¼ë‹¤" />
    <meta property="og:locale" content="ko_KR" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://hand.funnyfunny.cloud/" />
    <meta
      name="twitter:title"
      content="ì†ë°”ë‹¥ ì° í‘¼ë‹¤ - ì‚¬ì§„ í•œ ì¥ìœ¼ë¡œ ë³´ëŠ” ì†ê¸ˆ ì„±í–¥ ë¶„ì„"
    />
    <meta
      name="twitter:description"
      content="ì†ë°”ë‹¥ ì‚¬ì§„ë§Œ ì˜¬ë¦¬ë©´ 3ì´ˆ ë§Œì— ì†ê¸ˆ ì„±í–¥ì„ ë¶„ì„í•´ì£¼ëŠ” ë¬´ë£Œ ì›¹ í…ŒìŠ¤íŠ¸. ì§€ëŠ¥ì„ , ê°ì •ì„ , ìƒëª…ì„ ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹¹ì‹ ì˜ ì„±í–¥ì„ ì¹´ë“œë¡œ ì „ë‹¬í•©ë‹ˆë‹¤."
    />
    <meta
      name="twitter:image"
      content="https://dummyimage.com/1200x630/0f172a/ffffff&amp;text=Hand+Gold"
    />
    <meta name="twitter:image:alt" content="ì†ë°”ë‹¥ ì° í‘¼ë‹¤" />

    <!-- Additional Meta Tags -->
    <meta name="theme-color" content="#111217" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="ì†ë°”ë‹¥ ì° í‘¼ë‹¤" />
    <link rel="canonical" href="https://hand.funnyfunny.cloud/" />

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "ì†ë°”ë‹¥ ì° í‘¼ë‹¤",
        "description": "ì†ë°”ë‹¥ ì‚¬ì§„ë§Œ ì˜¬ë¦¬ë©´ 3ì´ˆ ë§Œì— ì†ê¸ˆ ì„±í–¥ì„ ë¶„ì„í•´ì£¼ëŠ” ë¬´ë£Œ ì›¹ í…ŒìŠ¤íŠ¸",
        "url": "https://hand.funnyfunny.cloud/",
        "applicationCategory": "EntertainmentApplication",
        "operatingSystem": "Any",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "KRW"
        },
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.5",
          "ratingCount": "100"
        },
        "featureList": [
          "ì†ë°”ë‹¥ ì‚¬ì§„ ì—…ë¡œë“œ",
          "3ì´ˆ ë‚´ ì†ê¸ˆ ë¶„ì„",
          "ì§€ëŠ¥ì„ , ê°ì •ì„ , ìƒëª…ì„  í•´ì„",
          "ì„±í–¥ ì¹´ë“œ ìƒì„±",
          "ë¸Œë¼ìš°ì € ë‚´ ì¦‰ì‹œ ì‘ë™"
        ]
      }
    </script>
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%230c0d12'/%3E%3Ctext x='50' y='72' font-size='65' text-anchor='middle' dominant-baseline='central' font-family='Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji, sans-serif'%3Eâœ‹%3C/text%3E%3C/svg%3E"
    />
    <link
      rel="apple-touch-icon"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%230c0d12'/%3E%3Ctext x='50' y='72' font-size='65' text-anchor='middle' dominant-baseline='central' font-family='Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji, sans-serif'%3Eâœ‹%3C/text%3E%3C/svg%3E"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Fraunces:opsz@9..144&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg: #0c0d12;
        --panel: rgba(19, 20, 28, 0.75);
        --accent: #8df7b5;
        --accent-2: #f7e88d;
        --muted: #a6acbc;
        --text: #f6f7fb;
        --shadow: 0 10px 60px rgba(0, 0, 0, 0.45);
        --radius: 18px;
        --blur: saturate(120%) blur(18px);
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: "Space Grotesk", "Pretendard", system-ui, -apple-system,
          sans-serif;
        background: radial-gradient(
            120% 120% at 15% 15%,
            rgba(141, 247, 181, 0.08),
            transparent
          ),
          radial-gradient(
            120% 120% at 85% 25%,
            rgba(247, 232, 141, 0.07),
            transparent
          ),
          linear-gradient(145deg, #0c0d12 0%, #0d1118 55%, #0b0d12 100%);
        color: var(--text);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        padding: 32px 18px 60px;
      }
      .shell {
        width: min(1080px, 100%);
        max-width: 100%;
        margin: 0 auto;
        background: var(--panel);
        border: 1px solid rgba(255, 255, 255, 0.05);
        border-radius: 28px;
        padding: 28px clamp(18px, 3vw, 32px) 34px;
        box-shadow: var(--shadow);
        position: relative;
        overflow: hidden;
      }
      .shell::before {
        content: "";
        position: absolute;
        inset: 0;
        background: radial-gradient(
            65% 70% at 20% 0%,
            rgba(141, 247, 181, 0.08),
            transparent
          ),
          radial-gradient(
            75% 80% at 80% 10%,
            rgba(247, 232, 141, 0.08),
            transparent
          );
        pointer-events: none;
        z-index: 0;
      }
      header {
        position: relative;
        z-index: 1;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        margin-bottom: 26px;
      }
      .logo {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .logo span {
        font-weight: 700;
        letter-spacing: -0.5px;
        font-size: 20px;
      }
      .badge {
        padding: 6px 12px;
        border-radius: 999px;
        background: rgba(141, 247, 181, 0.12);
        color: var(--accent);
        font-size: 13px;
        border: 1px solid rgba(141, 247, 181, 0.32);
      }
      h1 {
        margin: 0;
        font-size: clamp(26px, 5vw, 40px);
        line-height: 1.1;
        letter-spacing: -0.6px;
        font-family: "Fraunces", "Space Grotesk", serif;
      }
      .sub {
        margin: 10px 0 0;
        color: var(--muted);
        font-size: 15px;
      }
      .grid {
        position: relative;
        z-index: 1;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 16px;
        margin-top: 22px;
      }
      .panel {
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: var(--radius);
        padding: 18px;
        box-shadow: var(--shadow);
        backdrop-filter: var(--blur);
      }
      .uploader {
        border: 1.3px dashed rgba(255, 255, 255, 0.18);
        border-radius: var(--radius);
        padding: 18px;
        min-height: 220px;
        display: grid;
        gap: 10px;
        align-content: center;
        justify-items: center;
        cursor: pointer;
        transition: border-color 0.2s ease, background 0.2s ease;
      }
      .uploader:hover {
        border-color: rgba(141, 247, 181, 0.4);
        background: rgba(141, 247, 181, 0.02);
      }
      .uploader.dragover {
        border-color: var(--accent);
        background: rgba(141, 247, 181, 0.05);
      }
      .uploader input {
        display: none;
      }
      .hint {
        color: var(--muted);
        font-size: 13px;
        text-align: center;
      }
      .cta {
        background: linear-gradient(135deg, var(--accent), #9ef7e5);
        color: #0b0d12;
        border: none;
        border-radius: 12px;
        padding: 12px 18px;
        font-weight: 700;
        cursor: pointer;
        box-shadow: 0 10px 40px rgba(141, 247, 181, 0.35);
        transition: transform 0.15s ease, box-shadow 0.15s ease;
      }
      .cta:hover {
        transform: translateY(-1px);
        box-shadow: 0 12px 40px rgba(141, 247, 181, 0.45);
      }
      .cta:active {
        transform: translateY(0);
      }
      .preview {
        width: 100%;
        border-radius: 12px;
        object-fit: cover;
        background: #111318;
        border: 1px solid rgba(255, 255, 255, 0.06);
      }
      .hidden {
        display: none !important;
      }
      .loading {
        display: grid;
        gap: 10px;
        justify-items: center;
        text-align: center;
      }
      .loader {
        width: 64px;
        height: 64px;
        border-radius: 50%;
        border: 2px solid rgba(141, 247, 181, 0.2);
        border-top-color: var(--accent);
        animation: spin 1s linear infinite;
      }
      .loading p {
        margin: 0;
        color: var(--muted);
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
      .cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 12px;
        margin-top: 12px;
      }
      .card {
        padding: 14px;
        background: rgba(255, 255, 255, 0.03);
        border-radius: 14px;
        border: 1px solid rgba(255, 255, 255, 0.06);
        display: grid;
        gap: 6px;
      }
      .card h3 {
        margin: 0;
        font-size: 15px;
        letter-spacing: -0.2px;
        display: flex;
        align-items: center;
        gap: 6px;
      }
      .pill {
        font-size: 12px;
        color: #0b0d12;
        background: var(--accent-2);
        padding: 4px 8px;
        border-radius: 999px;
        font-weight: 700;
      }
      .card p {
        margin: 0;
        color: var(--muted);
        font-size: 13px;
        line-height: 1.5;
      }
      .meta {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin-top: 12px;
      }
      .chip {
        padding: 6px 10px;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.05);
        color: var(--muted);
        font-size: 12px;
        border: 1px solid rgba(255, 255, 255, 0.05);
      }
      .share {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        align-items: center;
        margin-top: 16px;
      }
      .ghost {
        background: transparent;
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.16);
        border-radius: 12px;
        padding: 10px 14px;
        cursor: pointer;
        transition: border-color 0.2s ease, background 0.2s ease;
      }
      .ghost:hover {
        border-color: var(--accent);
        background: rgba(141, 247, 181, 0.05);
      }
      footer {
        margin-top: 20px;
        color: var(--muted);
        font-size: 12px;
        text-align: center;
      }
      .tips {
        display: grid;
        gap: 10px;
      }
      .tips strong {
        color: var(--text);
      }
      .alert {
        margin-top: 12px;
        padding: 10px 12px;
        border-radius: 12px;
        background: rgba(255, 99, 99, 0.08);
        border: 1px solid rgba(255, 99, 99, 0.2);
        color: #ffb3b3;
        font-size: 13px;
      }
      .ok {
        background: rgba(141, 247, 181, 0.08);
        border-color: rgba(141, 247, 181, 0.2);
        color: var(--accent);
      }
      .other-services {
        display: flex;
        justify-content: center;
        padding-top: 32px;
        margin-top: 48px;
        border-top: 1px solid rgba(255, 255, 255, 0.08);
        position: relative;
        z-index: 1;
      }
      .other-services-link {
        padding: 12px 24px;
        background: rgba(255, 255, 255, 0.05);
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 12px;
        font-weight: 500;
        text-decoration: none;
        transition: all 0.2s ease;
        font-size: 14px;
      }
      .other-services-link:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: rgba(255, 255, 255, 0.18);
        transform: translateY(-1px);
      }
      @media (max-width: 640px) {
        header {
          flex-direction: column;
          align-items: flex-start;
        }
        .shell {
          padding: 22px 16px 28px;
        }
        .uploader {
          min-height: 180px;
        }
        .other-services {
          padding-top: 24px;
          margin-top: 32px;
        }
        .other-services-link {
          padding: 10px 20px;
          font-size: 13px;
        }
      }
    </style>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1204894220949193"
     crossorigin="anonymous"></script>
    <!-- responsive-base -->
    <style>
      /* responsive-base */
      *, *::before, *::after {
        box-sizing: border-box;
      }
      html {
        -webkit-text-size-adjust: 100%;
      }
      img,
      video,
      canvas,
      svg {
        max-width: 100%;
        height: auto;
      }
      table {
        width: 100%;
      }
      pre,
      code {
        white-space: pre-wrap;
        word-break: break-word;
      }
    </style>
  <style>
    .adsense-block {
      margin: 16px 0;
      display: flex;
      justify-content: center;
    }
    .adsbygoogle {
      display: block;
      margin: 16px auto;
        text-align: center;
}
    .lang-switch {
      position: fixed;
      top: 16px;
      right: 16px;
      display: inline-flex;
      gap: 0;
      padding: 3px;
      border-radius: 999px;
      background: rgba(17, 18, 23, 0.95);
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
      z-index: 100;
      border: 1px solid rgba(141, 247, 181, 0.2);
    }
    .lang-switch button {
      border: none;
      background: transparent;
      color: rgba(255, 255, 255, 0.6);
      font-size: 12px;
      font-weight: 700;
      padding: 7px 14px;
      border-radius: 999px;
      cursor: pointer;
      transition: all 0.2s ease;
      min-width: 44px;
      text-align: center;
      letter-spacing: 0.02em;
    }
    .lang-switch button.active {
      background: rgba(141, 247, 181, 0.3);
      color: #fff;
      box-shadow: 0 2px 8px rgba(141, 247, 181, 0.4);
    }
    .lang-switch button:not(.active):hover {
      background: rgba(141, 247, 181, 0.1);
      color: rgba(255, 255, 255, 0.9);
    }
  </style>
</head>
  <body>
    <div class="lang-switch" role="tablist" aria-label="Language switcher">
      <button type="button" data-lang="ko" class="active">KR</button>
      <button type="button" data-lang="en">EN</button>
    </div>
    <div class="shell">
      <header>
        <div class="logo">
          <span data-i18n="logo">âœ‹ ì†ë°”ë‹¥ ì° í‘¼ë‹¤</span>
          <span class="badge" data-i18n="badge">ì›¹Â·ì¦‰ì‹œ ë¶„ì„</span>
        </div>
        <div class="hint" data-i18n="headerHint">ì†ë°”ë‹¥ ì‚¬ì§„ì„ ì˜¬ë¦¬ë©´ 3ì´ˆ ì•ˆì— ì„±í–¥ ì¹´ë“œ ìƒì„±</div>
      </header>

      <section class="panel">
        <h1 data-i18n="title">ì‚¬ì§„ í•œ ì¥ìœ¼ë¡œ ë³´ëŠ” ì†ê¸ˆ íë¦„</h1>
        <p class="sub" data-i18n="subtitle">
          ì†ë°”ë‹¥ í•œ ì¥ìœ¼ë¡œ ì•Œì•„ë³´ëŠ” ë‹¹ì‹ ì˜ ì„±í–¥. ì§€ëŠ¥ì„ , ê°ì •ì„ , ìƒëª…ì„ ì„
          ê¸°ë°˜ìœ¼ë¡œ ê°œì¸í™”ëœ í•´ì„ì„ 3ì´ˆ ë§Œì— ì „ë‹¬í•©ë‹ˆë‹¤.
        </p>
      </section>

      <div class="grid" style="margin-top: 18px">
        <section class="panel">
          <label class="uploader" id="dropZone">
            <input type="file" accept="image/*" id="palmInput" />
            <div style="font-size: 38px">ğŸ“¤</div>
            <div data-i18n="uploadDrag">ì†ë°”ë‹¥ ì‚¬ì§„ì„ ëŒì–´ë†“ê±°ë‚˜ íƒ­í•´ì„œ ì—…ë¡œë“œ</div>
            <div class="hint" data-i18n="uploadHint">ì¹´ë©”ë¼ë„ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥ Â· JPG/PNG ê¶Œì¥</div>
            <button class="cta" type="button" id="triggerUpload" data-i18n="uploadBtn">
              ì‚¬ì§„ ì„ íƒ
            </button>
          </label>
          <div id="previewArea" class="hidden">
            <p class="hint" data-i18n="uploadedPhoto">ì—…ë¡œë“œí•œ ì‚¬ì§„</p>
            <img id="preview" class="preview" data-i18n-alt="previewAlt" alt="ì†ë°”ë‹¥ ë¯¸ë¦¬ë³´ê¸°" />
            <div id="detectMsg" class="alert hidden"></div>
          </div>
        </section>

        <section class="panel">
          <div id="idleCopy">
            <h3 style="margin: 0 0 8px" data-i18n="howItWorks">ì–´ë–»ê²Œ ì‘ë™í•˜ë‚˜ìš”?</h3>
            <div class="tips">
              <div>
                <strong>1.</strong> <span data-i18n="howItWorks1">ì‚¬ì§„ì„ ì˜¬ë¦¬ë©´ ë©”íƒ€ë°ì´í„°(ë¹„ìœ¨Â·ë°ê¸°Â·í¬ê¸°)ë¥¼ ì½ìŠµë‹ˆë‹¤.</span>
              </div>
              <div>
                <strong>2.</strong> <span data-i18n="howItWorks2">ì†ë°”ë‹¥ í˜•íƒœì™€ ì„ ì˜ íŒ¨í„´ì„ ë¶„ì„í•©ë‹ˆë‹¤.</span>
              </div>
              <div>
                <strong>3.</strong> <span data-i18n="howItWorks3">ë©”íƒ€ ì •ë³´ì— ë§ì¶˜ ì†ê¸ˆ í•´ì„ ì¹´ë“œë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.</span>
              </div>
            </div>
          </div>
          <div id="loading" class="loading hidden">
            <div class="loader"></div>
            <p id="loadingText" data-i18n="loadingReading">ì†ê¸ˆ ì„ ì„ ì½ëŠ” ì¤‘...</p>
            <p class="hint" id="loadingHint" data-i18n="loadingHint">
              ë‹¹ì‹ ì˜ ì¸ìƒ íë¦„ì„ ì •ë¦¬í•˜ê³  ìˆì–´ìš”
            </p>
          </div>
          <div id="result" class="hidden">
            <div class="meta" id="metaChips"></div>
            <div class="cards" id="cards"></div>
            <div class="share">
              <button class="cta" type="button" id="shareBtn" data-i18n="shareBtn">ê²°ê³¼ ê³µìœ </button>
              <button class="ghost" type="button" id="copyBtn" data-i18n="copyBtn">
                ë§í¬ ë³µì‚¬
              </button>
              <span class="hint" id="shareStatus"></span>
            </div>
          </div>
        </section>
      </div>

      <div class="other-services">
        <a
          href="https://funnyfunny.cloud/"
          target="_blank"
          rel="noopener noreferrer"
          class="other-services-link"
          data-i18n="otherServices">ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ë³´ê¸°</a
        >
      </div>

      <footer data-i18n="footer">
        ë³¸ í…ŒìŠ¤íŠ¸ëŠ” ì‹¬ë¦¬ ê¸°ë°˜ ì—”í„°í…Œì¸ë¨¼íŠ¸ MVPì…ë‹ˆë‹¤. ì—…ë¡œë“œëœ ì‚¬ì§„ì€ ë¸Œë¼ìš°ì €
        ë‚´ì—ì„œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
      </footer>
    </div>

    <script type="module">
      /* i18n */
      const translations = {
        ko: {
          metaTitle: "ì†ë°”ë‹¥ ì° í‘¼ë‹¤ - ì‚¬ì§„ í•œ ì¥ìœ¼ë¡œ ë³´ëŠ” ì†ê¸ˆ ì„±í–¥ ë¶„ì„",
          metaDescription: "ì†ë°”ë‹¥ ì‚¬ì§„ë§Œ ì˜¬ë¦¬ë©´ 3ì´ˆ ë§Œì— ì†ê¸ˆ ì„±í–¥ì„ ë¶„ì„í•´ì£¼ëŠ” ë¬´ë£Œ ì›¹ í…ŒìŠ¤íŠ¸. ì§€ëŠ¥ì„ , ê°ì •ì„ , ìƒëª…ì„ ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹¹ì‹ ì˜ ì„±í–¥ì„ ì¹´ë“œë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.",
          logo: "âœ‹ ì†ë°”ë‹¥ ì° í‘¼ë‹¤",
          badge: "ì›¹Â·ì¦‰ì‹œ ë¶„ì„",
          headerHint: "ì†ë°”ë‹¥ ì‚¬ì§„ì„ ì˜¬ë¦¬ë©´ 3ì´ˆ ì•ˆì— ì„±í–¥ ì¹´ë“œ ìƒì„±",
          title: "ì‚¬ì§„ í•œ ì¥ìœ¼ë¡œ ë³´ëŠ” ì†ê¸ˆ íë¦„",
          subtitle: "ì†ë°”ë‹¥ í•œ ì¥ìœ¼ë¡œ ì•Œì•„ë³´ëŠ” ë‹¹ì‹ ì˜ ì„±í–¥. ì§€ëŠ¥ì„ , ê°ì •ì„ , ìƒëª…ì„ ì„ ê¸°ë°˜ìœ¼ë¡œ ê°œì¸í™”ëœ í•´ì„ì„ 3ì´ˆ ë§Œì— ì „ë‹¬í•©ë‹ˆë‹¤.",
          uploadDrag: "ì†ë°”ë‹¥ ì‚¬ì§„ì„ ëŒì–´ë†“ê±°ë‚˜ íƒ­í•´ì„œ ì—…ë¡œë“œ",
          uploadHint: "ì¹´ë©”ë¼ë„ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥ Â· JPG/PNG ê¶Œì¥",
          uploadBtn: "ì‚¬ì§„ ì„ íƒ",
          uploadedPhoto: "ì—…ë¡œë“œí•œ ì‚¬ì§„",
          previewAlt: "ì†ë°”ë‹¥ ë¯¸ë¦¬ë³´ê¸°",
          howItWorks: "ì–´ë–»ê²Œ ì‘ë™í•˜ë‚˜ìš”?",
          howItWorks1: "ì‚¬ì§„ì„ ì˜¬ë¦¬ë©´ ë©”íƒ€ë°ì´í„°(ë¹„ìœ¨Â·ë°ê¸°Â·í¬ê¸°)ë¥¼ ì½ìŠµë‹ˆë‹¤.",
          howItWorks2: "ì†ë°”ë‹¥ í˜•íƒœì™€ ì„ ì˜ íŒ¨í„´ì„ ë¶„ì„í•©ë‹ˆë‹¤.",
          howItWorks3: "ë©”íƒ€ ì •ë³´ì— ë§ì¶˜ ì†ê¸ˆ í•´ì„ ì¹´ë“œë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.",
          loadingReading: "ì†ê¸ˆ ì„ ì„ ì½ëŠ” ì¤‘...",
          loadingHint: "ë‹¹ì‹ ì˜ ì¸ìƒ íë¦„ì„ ì •ë¦¬í•˜ê³  ìˆì–´ìš”",
          shareBtn: "ê²°ê³¼ ê³µìœ ",
          copyBtn: "ë§í¬ ë³µì‚¬",
          shareStatusShared: "ê³µìœ  ì™„ë£Œ!",
          shareStatusCopied: "ë§í¬ë¥¼ ë³µì‚¬í–ˆì–´ìš”.",
          shareStatusCancelled: "ê³µìœ ê°€ ì·¨ì†Œëì–´ìš”.",
          copyStatusCopied: "ë§í¬ ë³µì‚¬ ì™„ë£Œ",
          copyStatusError: "ë³µì‚¬ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.",
          otherServices: "ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ë³´ê¸°",
          footer: "ë³¸ í…ŒìŠ¤íŠ¸ëŠ” ì‹¬ë¦¬ ê¸°ë°˜ ì—”í„°í…Œì¸ë¨¼íŠ¸ MVPì…ë‹ˆë‹¤. ì—…ë¡œë“œëœ ì‚¬ì§„ì€ ë¸Œë¼ìš°ì € ë‚´ì—ì„œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.",
          loadingModel: "ì† ì¸ì‹ ëª¨ë¸ ë¡œë”© ì¤‘...",
          loadingModelError: "ì† ì¸ì‹ ì´ˆê¸°í™” ì‹¤íŒ¨. ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•˜ê³  ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",
          handNotDetected: "ì†ë°”ë‹¥ì´ ê°ì§€ë˜ì§€ ì•Šì•˜ì–´ìš”. ì†ë°”ë‹¥ ë©´ì´ ë” í¬ê²Œ, ë°°ê²½ ëŒ€ë¹„ë¥¼ ë†’ì—¬ ë‹¤ì‹œ ì´¬ì˜í•´ì£¼ì„¸ìš”.",
          handDetected: "ì†ë°”ë‹¥ ê°ì§€ ì™„ë£Œ! ê°œì¸í™” í•´ì„ì„ ì¤€ë¹„í•©ë‹ˆë‹¤.",
          modelNotReady: "ì† ì¸ì‹ ëª¨ë¸ì´ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ì–´ìš”. ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",
          shareText: "ë‚´ ì†ê¸ˆ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ í™•ì¸í•´ë´ìš”",
          shareTitle: "ì†ê¸ˆ ìŠ¤ìºë„ˆ",
          // Loading states
          state1: "ì†ë°”ë‹¥ ê²°ì„ ìŠ¤ìº”í•˜ê³  ìˆì–´ìš”...",
          state2: "ì—ë„ˆì§€ íë¦„ì„ ì •ë ¬í•˜ëŠ” ì¤‘...",
          state3: "ë‹¹ì‹ ë§Œì˜ ì„±í–¥ ì§€ë„ë¥¼ ì¡°ë¦½ ì¤‘...",
          hint1: "ì‚¬ì§„ ì† ì§ˆê°ê³¼ ë¹„ìœ¨ì„ í•´ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤",
          hint2: "ì†ê°€ë½ ë²Œì–´ì§ê³¼ ì„ ì˜ íë¦„ì„ ë§¤ì¹­ ì¤‘ì…ë‹ˆë‹¤",
          hint3: "ì„±í–¥ ì¹´ë“œì— ë“¤ì–´ê°ˆ í•µì‹¬ ë¬¸ì¥ì„ ê³ ë¥´ê³  ìˆì–´ìš”",
          // Type names
          typeFormOpenWide: "ë„“ê²Œ ì—´ë¦° ì‹¤í–‰í˜•",
          typeFormOpenTall: "ê¸¸ê²Œ ë»—ì€ ì‚¬ê³ í˜•",
          typeFormBalanced: "ê· í˜•í˜•",
          typeHeadDeepThinker: "ê¹Šì´ ì‚¬ê³ í˜•",
          typeHeadRealist: "í˜„ì‹¤ ì‹¤í–‰í˜•",
          typeHeadFlexMaker: "ìœ ì—° ì¡°ìœ¨í˜•",
          typeEmotionStableRealist: "ë‹´ë°± ì•ˆì •í˜•",
          typeEmotionWarmCurve: "ì˜¨ë„ ìœ ì§€í˜•",
          typeEmotionSpark: "ì§§ê³  êµµê²Œ ëª°ì…í˜•",
          typeLifeStaminaSteady: "ê¾¸ì¤€ ì¥ê¸°ì „í˜•",
          typeLifeBursty: "ìŠ¤í”„ë¦°íŠ¸í˜•",
          typeLifeResilient: "íšŒë³µ íƒ„íƒ„í˜•",
          // Tags
          tagForm: "í˜•íƒœ",
          tagHead: "ì§€ëŠ¥ì„ ",
          tagEmotion: "ê°ì •ì„ ",
          tagLife: "ìƒëª…ì„ ",
          tagSummary: "ì´í‰",
          summaryTitle: "ì˜¤ëŠ˜ì˜ ì†ê¸ˆ ë¦¬í¬íŠ¸",
          summaryAction: "ì¶”ì²œ ì•¡ì…˜: ë¦¬ë“¬ ìœ ì§€, ììœ¨ì„± ì¡´ì¤‘, ê²°ì • í›„ì—ëŠ” ê¾¸ì¤€íˆ ë°€ì–´ë¶™ì´ê¸°. ê°ì • ì†Œëª¨ í° ê´€ê³„ë³´ë‹¨ ì‹ ë¢°/ì¼ìƒ ê¸°ë°˜ ê´€ê³„ì— ê°•ì .",
          // Type copy
          copyFormOpenWide: "ë„“ê³  ì—¬ìœ ë¡œìš´ í˜•íƒœ â†’ ì‹¤í–‰í˜•Â·í˜„ì‹¤í˜•",
          copyFormOpenTall: "ê¸¸ê³  ëŠ˜ì”¬í•œ í˜•íƒœ â†’ ì‚¬ê³ í˜•Â·ë¶„ì„í˜•",
          copyFormBalanced: "ê· í˜• ì¡íŒ í˜•íƒœ â†’ ì¡°ìœ¨í˜•",
          copyHeadDeepThinker: "ê¸¸ê³  ì™„ë§Œí•œ ì§€ëŠ¥ì„  â†’ ê¹Šì´ ì‚¬ê³ , í˜¼ì íŒŒê³ ë“œëŠ” ìŠ¤íƒ€ì¼",
          copyHeadRealist: "ê³§ì€ ì§€ëŠ¥ì„  â†’ í˜„ì‹¤ íŒë‹¨ ë¹ ë¥¸ ì‹¤í–‰í˜•",
          copyHeadFlexMaker: "ì‚´ì§ êµ´ê³¡ ìˆëŠ” ì§€ëŠ¥ì„  â†’ ì§ê´€+í˜„ì‹¤ì„ ë²ˆê°ˆì•„ ì“°ëŠ” ìŠ¤íƒ€ì¼",
          copyEmotionStableRealist: "ì§ì„ í˜• ê°ì •ì„  â†’ ê°ì • ì ˆì œ, ì‹ ë¢°/ê· í˜• ì¤‘ì‹œ",
          copyEmotionWarmCurve: "ì™„ë§Œí•œ ê³¡ì„ í˜• â†’ ë°°ë ¤í˜•, ê´€ê³„ ì˜¨ë„ ìœ ì§€í˜•",
          copyEmotionSpark: "ì§§ê³  ìœ„ë¡œ ì¹˜ëŠ” ê°ì •ì„  â†’ ì§§ê³  êµµê²Œ ëª°ì…í˜•",
          copyLifeStaminaSteady: "ëŠê¹€ ì—†ëŠ” ìƒëª…ì„  â†’ ê¾¸ì¤€í•¨Â·ì¥ê¸°ì „ ê°•ì ",
          copyLifeBursty: "ì§§ê±°ë‚˜ ì–•ì€ ìƒëª…ì„  â†’ ëª°ì… í›„ íœ´ì‹ íŒ¨í„´",
          copyLifeResilient: "ì„ ëª…í•˜ê³  ê¹Šì€ ìƒëª…ì„  â†’ ì²´ë ¥Â·íšŒë³µë ¥ ìƒìœ„",
        },
        en: {
          metaTitle: "Hand Reading - Palm Reading Analysis from One Photo",
          metaDescription: "Free web test that analyzes your palm reading personality in 3 seconds just by uploading a palm photo. Delivers your personality through cards based on intelligence line, emotion line, and life line.",
          logo: "âœ‹ Hand Reading",
          badge: "Web Â· Instant Analysis",
          headerHint: "Upload a palm photo and get personality cards in 3 seconds",
          title: "Palm Reading Flow from One Photo",
          subtitle: "Discover your personality from one palm photo. Delivers personalized interpretation in 3 seconds based on intelligence line, emotion line, and life line.",
          uploadDrag: "Drag and drop or tap to upload palm photo",
          uploadHint: "Camera available Â· JPG/PNG recommended",
          uploadBtn: "Select Photo",
          uploadedPhoto: "Uploaded Photo",
          previewAlt: "Palm Preview",
          howItWorks: "How does it work?",
          howItWorks1: "When you upload a photo, it reads metadata (ratio, brightness, size).",
          howItWorks2: "Analyzes palm shape and line patterns.",
          howItWorks3: "Shows palm reading interpretation cards based on meta information.",
          loadingReading: "Reading palm lines...",
          loadingHint: "Organizing your life flow",
          shareBtn: "Share Result",
          copyBtn: "Copy Link",
          shareStatusShared: "Shared!",
          shareStatusCopied: "Link copied.",
          shareStatusCancelled: "Share cancelled.",
          copyStatusCopied: "Link copied",
          copyStatusError: "Please allow copy permission.",
          otherServices: "View Other Services",
          footer: "This test is a psychology-based entertainment MVP. Uploaded photos are used only within the browser.",
          loadingModel: "Loading hand recognition model...",
          loadingModelError: "Hand recognition initialization failed. Please check your network connection and refresh to try again.",
          handNotDetected: "Palm not detected. Please retake with palm facing larger and higher background contrast.",
          handDetected: "Palm detected! Preparing personalized interpretation.",
          modelNotReady: "Hand recognition model not ready. Please refresh and try again.",
          shareText: "Check out my palm reading test result",
          shareTitle: "Palm Scanner",
          // Loading states
          state1: "Scanning palm texture...",
          state2: "Aligning energy flow...",
          state3: "Assembling your personality map...",
          hint1: "Interpreting texture and ratio in the photo",
          hint2: "Matching finger spread and line flow",
          hint3: "Selecting key phrases for personality cards",
          // Type names
          typeFormOpenWide: "Wide Open Action Type",
          typeFormOpenTall: "Tall Extended Thinker Type",
          typeFormBalanced: "Balanced Type",
          typeHeadDeepThinker: "Deep Thinker",
          typeHeadRealist: "Realistic Action Type",
          typeHeadFlexMaker: "Flexible Coordinator",
          typeEmotionStableRealist: "Reserved Stable Type",
          typeEmotionWarmCurve: "Temperature Maintainer",
          typeEmotionSpark: "Short & Intense Immersive Type",
          typeLifeStaminaSteady: "Steady Long-term Type",
          typeLifeBursty: "Sprint Type",
          typeLifeResilient: "Resilient Recovery Type",
          // Tags
          tagForm: "Form",
          tagHead: "Intelligence Line",
          tagEmotion: "Emotion Line",
          tagLife: "Life Line",
          tagSummary: "Summary",
          summaryTitle: "Today's Palm Reading Report",
          summaryAction: "Recommended action: Maintain rhythm, respect autonomy, push forward consistently after decisions. Strong in trust/daily-based relationships rather than emotionally draining ones.",
          // Type copy
          copyFormOpenWide: "Wide and spacious form â†’ ActionÂ·Realistic type",
          copyFormOpenTall: "Long and slim form â†’ ThinkerÂ·Analytical type",
          copyFormBalanced: "Balanced form â†’ Coordinator type",
          copyHeadDeepThinker: "Long and gentle intelligence line â†’ Deep thinking, solo diving style",
          copyHeadRealist: "Straight intelligence line â†’ Fast reality judgment action type",
          copyHeadFlexMaker: "Slightly curved intelligence line â†’ Alternating intuition and reality style",
          copyEmotionStableRealist: "Straight emotion line â†’ Emotional restraint, values trust/balance",
          copyEmotionWarmCurve: "Gentle curved type â†’ Caring type, relationship temperature maintainer",
          copyEmotionSpark: "Short upward emotion line â†’ Short and intense immersive type",
          copyLifeStaminaSteady: "Unbroken life line â†’ ConsistencyÂ·long-term strength",
          copyLifeBursty: "Short or shallow life line â†’ Immersion then rest pattern",
          copyLifeResilient: "Clear and deep life line â†’ Top staminaÂ·recovery",
        }
      };
      const defaultLang = "ko";
      const supportedLangs = ["ko", "en"];
      let currentLang = defaultLang;
      function t(key, vars = {}) {
        const langTable = translations[currentLang] || translations.ko;
        const template = langTable?.[key] ?? translations.ko?.[key] ?? key;
        if (typeof template !== "string") return template;
        return template.replace(/\{(\w+)\}/g, (_, token) =>
          vars[token] !== undefined ? vars[token] : `{${token}}`
        );
      }
      function applyTranslations() {
        document.title = t("metaTitle");
        const desc = document.querySelector('meta[name="description"]');
        if (desc) desc.setAttribute("content", t("metaDescription"));
        document.documentElement.lang = currentLang;
        document.querySelectorAll("[data-i18n]").forEach((el) => {
          el.textContent = t(el.dataset.i18n);
        });
        document.querySelectorAll("[data-i18n-alt]").forEach((el) => {
          el.setAttribute("alt", t(el.dataset.i18nAlt));
        });
      }
      function setLang(lang, options = {}) {
        const nextLang = translations[lang] ? lang : defaultLang;
        currentLang = nextLang;
        document.documentElement.lang = nextLang;
        localStorage.setItem("preferredLang", nextLang);
        document.querySelectorAll(".lang-switch button").forEach((button) => {
          button.classList.toggle("active", button.dataset.lang === nextLang);
        });
        applyTranslations();
        // Re-render result if exists
        if (window.lastMeta && window.lastTypes && window.lastInsights && typeof renderResult === "function") {
          renderResult(window.lastMeta, window.lastTypes, window.lastInsights);
        }
        if (options.updateUrl) {
          const url = new URL(window.location.href);
          url.searchParams.set("lang", nextLang);
          window.history.replaceState({}, "", url);
        }
      }
      function detectLang() {
        const params = new URLSearchParams(window.location.search);
        const paramLang = params.get("lang");
        if (supportedLangs.includes(paramLang)) return paramLang;
        const stored = localStorage.getItem("preferredLang");
        if (supportedLangs.includes(stored)) return stored;
        const browserLang =
          navigator.languages && navigator.languages.length
            ? navigator.languages[0]
            : navigator.language;
        if (browserLang && browserLang.toLowerCase().startsWith("ko")) {
          return "ko";
        }
        return defaultLang;
      }
      document.querySelectorAll(".lang-switch button").forEach((button) => {
        button.addEventListener("click", () => {
          setLang(button.dataset.lang, { updateUrl: true });
        });
      });
      setLang(detectLang(), { updateUrl: false });
      
      // Make t() function and currentLang globally available
      window.t = t;
      window.currentLang = currentLang;
      window.setLang = setLang;

      import {
        FilesetResolver,
        HandLandmarker,
      } from "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.0";

      const input = document.getElementById("palmInput");
      const dropZone = document.getElementById("dropZone");
      const triggerUpload = document.getElementById("triggerUpload");
      const preview = document.getElementById("preview");
      const previewArea = document.getElementById("previewArea");
      const detectMsg = document.getElementById("detectMsg");
      const loading = document.getElementById("loading");
      const loadingText = document.getElementById("loadingText");
      const loadingHint = document.getElementById("loadingHint");
      const result = document.getElementById("result");
      const idleCopy = document.getElementById("idleCopy");
      const cards = document.getElementById("cards");
      const metaChips = document.getElementById("metaChips");
      const shareBtn = document.getElementById("shareBtn");
      const copyBtn = document.getElementById("copyBtn");
      const shareStatus = document.getElementById("shareStatus");

      function getStates() {
        const tFunc = window.t || ((key) => key);
        return [
          tFunc("state1"),
          tFunc("state2"),
          tFunc("state3"),
        ];
      }
      function getHints() {
        const tFunc = window.t || ((key) => key);
        return [
          tFunc("hint1"),
          tFunc("hint2"),
          tFunc("hint3"),
        ];
      }

      let lastLandmarks = null;
      let handLandmarker = null;
      let handInitPromise = null;
      async function initHand() {
        if (handInitPromise) return handInitPromise;
        handInitPromise = (async () => {
          if (!detectMsg) return;
          detectMsg.classList.remove("hidden");
          const tFunc = window.t || ((key) => key);
          detectMsg.textContent = tFunc("loadingModel");
          try {
            const fileset = await FilesetResolver.forVisionTasks(
              "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.0/wasm"
            );
            handLandmarker = await HandLandmarker.createFromOptions(fileset, {
              baseOptions: {
                // Use official hosted model (jsdelivr íŒ¨í‚¤ì§€ì—ëŠ” ëª¨ë¸ì´ ì—†ìœ¼ë¯€ë¡œ GCS ê²½ë¡œ ì‚¬ìš©)
                modelAssetPath:
                  "https://storage.googleapis.com/mediapipe-models/hand_landmarker/hand_landmarker/float16/1/hand_landmarker.task",
              },
              runningMode: "IMAGE",
              numHands: 1,
              minHandDetectionConfidence: 0.15,
              minHandPresenceConfidence: 0.15,
            });
            detectMsg.classList.add("hidden");
          } catch (err) {
            handLandmarker = null;
            const tFunc = window.t || ((key) => key);
            detectMsg.textContent = tFunc("loadingModelError");
          }
        })();
        return handInitPromise;
      }
      initHand();

      const typeInsights = {
        form: {
          OPEN_WIDE: [
            "ì†ë°”ë‹¥ì´ ë„“ì€ ì‹¤í–‰í˜•. í˜„ì‹¤ ê°ê°ê³¼ ì¶”ì§„ë ¥ì´ ê°•í•©ë‹ˆë‹¤.",
            "íŒì„ í‚¤ìš°ê³  ì‹¤í–‰í•˜ëŠ” ë° ê°•ì . í˜‘ì—…ë³´ë‹¤ ìê¸° ì†ë„ë¡œ ë°€ì–´ë¶™ì´ëŠ” í¸ì…ë‹ˆë‹¤.",
          ],
          OPEN_TALL: [
            "ê¸¸ê³  ëŠ˜ì”¬í•œ ì‚¬ê³ í˜•. ì•„ì´ë””ì–´Â·ë¶„ì„ì— ê°•í•©ë‹ˆë‹¤.",
            "ë¨¸ë¦¬ë¥¼ ë§ì´ ì“°ëŠ” êµ¬ì¡°ë¼ ë°©í–¥ë§Œ ì¡íˆë©´ ê¹Šê²Œ íŒŒê³ ë“­ë‹ˆë‹¤.",
          ],
          BALANCED: [
            "ê· í˜•í˜• ì†ë°”ë‹¥. ìƒí™©ì— ë§ì¶° ì‹¤í–‰ê³¼ ì‚¬ê³ ë¥¼ ì¡°ìœ¨í•©ë‹ˆë‹¤.",
            "í˜‘ì—…Â·ì¡°ìœ¨ì— ê°•í•˜ê³ , ì¤‘ì¬ì í¬ì§€ì…˜ì— ì–´ìš¸ë¦½ë‹ˆë‹¤.",
          ],
        },
        head: {
          DEEP_THINKER: [
            "ì§€ëŠ¥ì„ ì´ ê¸¸ê³  ì™„ë§Œí•œ íƒ€ì…. ê¹Šì´ ìƒê°í•˜ê³  í˜¼ìì„œë„ ê²°ì •ì„ ëê¹Œì§€ ë°€ì–´ë¶™ì…ë‹ˆë‹¤.",
            "ê¸°íš/ê¸€ì“°ê¸°/ì„¤ê³„ ìª½ì— ì˜ ë§ìœ¼ë©°, ìê¸° ê¸°ì¤€ì´ ëª…í™•í•©ë‹ˆë‹¤.",
          ],
          REALIST: [
            "í˜„ì‹¤ íŒë‹¨ì´ ë¹ ë¥¸ íƒ€ì…. ì‹¤í–‰ê³¼ íŒë‹¨ ì‚¬ì´ ê±°ë¦¬ê°€ ì§§ìŠµë‹ˆë‹¤.",
            "â€œìƒê°â†’ë°”ë¡œ í–‰ë™â€ êµ¬ì¡°ë¼ ìŠ¤íƒ€íŠ¸ì—…í˜• ì—…ë¬´ì— ê°•í•©ë‹ˆë‹¤.",
          ],
          FLEX_MAKER: [
            "ì§ê´€ê³¼ í˜„ì‹¤ì„ ë²ˆê°ˆì•„ ì“°ëŠ” íƒ€ì…. ìƒí™©ì— ë”°ë¼ ì „ëµì„ ìœ ì—°í•˜ê²Œ ìˆ˜ì •í•©ë‹ˆë‹¤.",
            "ì‚¬ëŒÂ·ì¼ ì‚¬ì´ì˜ ê· í˜•ì„ ì˜ ì¡ì•„ì£¼ëŠ” ì¡°ìœ¨ìí˜•ì…ë‹ˆë‹¤.",
          ],
        },
        emotion: {
          STABLE_REALIST: [
            "ê°ì •ì„ ì´ ì§ì„ í˜•. ê°ì • í‘œí˜„ì€ ë‹´ë°±í•˜ê³  ì‹ ë¢°/ì§€ì†ì„±ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤.",
            "ë“œë¼ë§ˆë³´ë‹¤ ì¼ìƒ ê³µìœ ë¥¼ ì„ í˜¸í•˜ë©°, ê°ì • ì†Œëª¨ í° ê´€ê³„ëŠ” ì˜¤ë˜ ê°€ì§€ ì•ŠìŠµë‹ˆë‹¤.",
          ],
          WARM_CURVE: [
            "ì™„ë§Œí•œ ê³¡ì„ í˜•. ë°°ë ¤í˜•ì´ê³  ê´€ê³„ ì˜¨ë„ë¥¼ ë¶€ë“œëŸ½ê²Œ ìœ ì§€í•©ë‹ˆë‹¤.",
            "ì£¼ë³€ì„ í¸ì•ˆí•˜ê²Œ ë§Œë“œëŠ” í˜‘ì—…í˜• ê´€ê³„ ìŠ¤íƒ€ì¼ì…ë‹ˆë‹¤.",
          ],
          SPARK: [
            "ì§§ê³  ìœ„ë¡œ ì¹˜ëŠ” ê°ì •ì„ . ì§§ê³  êµµê²Œ ëª°ì…í•˜ê³ , ì—´ì •ì´ ë¹ ë¥´ê²Œ ë¶™ìŠµë‹ˆë‹¤.",
            "ê°•í•œ ê°ì • ëª°ì… í›„ íœ´ì‹ì´ í•„ìš”í•œ í¸ì…ë‹ˆë‹¤.",
          ],
        },
        life: {
          STAMINA_STEADY: [
            "ëŠê¹€ ì—†ëŠ” ìƒëª…ì„ . ì¥ê¸°ì „ì—ì„œ ê°•í•˜ê³  ê¾¸ì¤€í•¨ì´ ë¬´ê¸°ì…ë‹ˆë‹¤.",
            "ë¦¬ë“¬ë§Œ ìœ ì§€í•˜ë©´ ì•ˆì •ì ìœ¼ë¡œ ì„±ê³¼ë¥¼ ìŒ“ìŠµë‹ˆë‹¤.",
          ],
          BURSTY: [
            "ì§§ê±°ë‚˜ ì–•ì€ ìƒëª…ì„ . ëª°ì…â†’íœ´ì‹ íŒ¨í„´ì´ ë°˜ë³µë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
            "ì§‘ì¤‘ íƒ€ì´ë°ì„ ì¡ì•„ ì§§ì€ ìŠ¤í”„ë¦°íŠ¸ë¥¼ ì„¤ê³„í•˜ë©´ ì„±ê³¼ê°€ ë‚©ë‹ˆë‹¤.",
          ],
          RESILIENT: [
            "ì„ ëª…í•˜ê³  ê¹Šì€ ìƒëª…ì„ . íšŒë³µë ¥ì´ ì¢‹ê³  ì²´ë ¥ ê¸°ë°˜ì´ íƒ„íƒ„í•©ë‹ˆë‹¤.",
            "ë§ì€ ì¼ì„ ë§¡ì•„ë„ ë²„í‹°ëŠ” í¸ì´ì§€ë§Œ, ê³¼ë„í•œ ê³¼ë¡œë§Œ í”¼í•˜ë©´ ë©ë‹ˆë‹¤.",
          ],
        },
      };

      const pick = (list) => list[Math.floor(Math.random() * list.length)];

      function extractMeta(img, file) {
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");
        canvas.width = img.naturalWidth;
        canvas.height = img.naturalHeight;
        ctx.drawImage(img, 0, 0);
        const data = ctx.getImageData(0, 0, canvas.width, canvas.height).data;

        // Sample every 40th pixel for quick brightness estimation.
        let sum = 0;
        for (let i = 0; i < data.length; i += 4 * 40) {
          sum += (data[i] + data[i + 1] + data[i + 2]) / 3;
        }
        const avgBrightness = Math.round(sum / (data.length / (4 * 40)));
        const aspect = img.naturalWidth / img.naturalHeight;
        const sizeKB = Math.round((file.size / 1024) * 10) / 10;
        // Quick texture estimate: pixel variance proxy to guess ì„ ì´ ë§ì€ì§€ ì—¬ë¶€.
        let variance = 0;
        let samples = 0;
        for (let i = 0; i < data.length; i += 4 * 80) {
          const r = data[i],
            g = data[i + 1],
            b = data[i + 2];
          const v = (r + g + b) / 3;
          variance += v * v;
          samples += 1;
        }
        const textureScore = Math.sqrt(variance / samples) / 255;
        return { brightness: avgBrightness, aspect, sizeKB, textureScore };
      }

      // Very lightweight skin-likeness heuristic as a fallback: checks sampled pixels for skin-like RGB ranges.
      function looksLikePalm(img) {
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");
        canvas.width = img.naturalWidth;
        canvas.height = img.naturalHeight;
        ctx.drawImage(img, 0, 0);
        const data = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
        let skinish = 0;
        let total = 0;
        for (let i = 0; i < data.length; i += 4 * 20) {
          const r = data[i],
            g = data[i + 1],
            b = data[i + 2];
          if (
            r > 80 &&
            g > 40 &&
            b > 20 &&
            r > g &&
            r > b &&
            Math.abs(r - g) > 5 &&
            r - b > 10
          ) {
            skinish += 1;
          }
          total += 1;
        }
        const ratio = skinish / total;
        return ratio > 0.15; // loose threshold; catches palms even with missing fingers.
      }

      function deriveMeasuresFromLandmarks(landmarks, img) {
        if (!landmarks) return null;
        const xs = landmarks.map((p) => p.x);
        const ys = landmarks.map((p) => p.y);
        const minX = Math.min(...xs),
          maxX = Math.max(...xs);
        const minY = Math.min(...ys),
          maxY = Math.max(...ys);
        const width = maxX - minX;
        const height = maxY - minY;
        const aspect = width / height;

        // Finger spread: distance between index tip(8) and pinky tip(20) normalized by width.
        const spread = Math.abs(landmarks[8].x - landmarks[20].x) / width;
        // Thumb openness: distance from wrist(0) to thumb tip(4) relative to width.
        const thumb = Math.abs(landmarks[4].x - landmarks[0].x) / width;
        return { aspect, spread, thumb };
      }

      function getTypeCopy() {
        const tFunc = window.t || ((key) => key);
        return {
          form: {
            OPEN_WIDE: tFunc("copyFormOpenWide"),
            OPEN_TALL: tFunc("copyFormOpenTall"),
            BALANCED: tFunc("copyFormBalanced"),
          },
          head: {
            DEEP_THINKER: tFunc("copyHeadDeepThinker"),
            REALIST: tFunc("copyHeadRealist"),
            FLEX_MAKER: tFunc("copyHeadFlexMaker"),
          },
          emotion: {
            STABLE_REALIST: tFunc("copyEmotionStableRealist"),
            WARM_CURVE: tFunc("copyEmotionWarmCurve"),
            SPARK: tFunc("copyEmotionSpark"),
          },
          life: {
            STAMINA_STEADY: tFunc("copyLifeStaminaSteady"),
            BURSTY: tFunc("copyLifeBursty"),
            RESILIENT: tFunc("copyLifeResilient"),
          },
        };
      }

      function getTypeNames() {
        const tFunc = window.t || ((key) => key);
        return {
          OPEN_WIDE: tFunc("typeFormOpenWide"),
          OPEN_TALL: tFunc("typeFormOpenTall"),
          BALANCED: tFunc("typeFormBalanced"),
          DEEP_THINKER: tFunc("typeHeadDeepThinker"),
          REALIST: tFunc("typeHeadRealist"),
          FLEX_MAKER: tFunc("typeHeadFlexMaker"),
          STABLE_REALIST: tFunc("typeEmotionStableRealist"),
          WARM_CURVE: tFunc("typeEmotionWarmCurve"),
          SPARK: tFunc("typeEmotionSpark"),
          STAMINA_STEADY: tFunc("typeLifeStaminaSteady"),
          BURSTY: tFunc("typeLifeBursty"),
          RESILIENT: tFunc("typeLifeResilient"),
        };
      }

      function getTypeInsights() {
        const isKo = currentLang === "ko";
        const tFunc = window.t || ((key) => key);
        return {
          form: {
            OPEN_WIDE: isKo ? [
              "ì†ë°”ë‹¥ì´ ë„“ì€ ì‹¤í–‰í˜•. í˜„ì‹¤ ê°ê°ê³¼ ì¶”ì§„ë ¥ì´ ê°•í•©ë‹ˆë‹¤.",
              "íŒì„ í‚¤ìš°ê³  ì‹¤í–‰í•˜ëŠ” ë° ê°•ì . í˜‘ì—…ë³´ë‹¤ ìê¸° ì†ë„ë¡œ ë°€ì–´ë¶™ì´ëŠ” í¸ì…ë‹ˆë‹¤.",
            ] : [
              "Wide palm action type. Strong sense of reality and drive.",
              "Strength in scaling and execution. Prefers pushing at own pace over collaboration.",
            ],
            OPEN_TALL: isKo ? [
              "ê¸¸ê³  ëŠ˜ì”¬í•œ ì‚¬ê³ í˜•. ì•„ì´ë””ì–´Â·ë¶„ì„ì— ê°•í•©ë‹ˆë‹¤.",
              "ë¨¸ë¦¬ë¥¼ ë§ì´ ì“°ëŠ” êµ¬ì¡°ë¼ ë°©í–¥ë§Œ ì¡íˆë©´ ê¹Šê²Œ íŒŒê³ ë“­ë‹ˆë‹¤.",
            ] : [
              "Long and slim thinker type. Strong in ideas and analysis.",
              "Structure that uses the brain a lot, dives deep once direction is set.",
            ],
            BALANCED: isKo ? [
              "ê· í˜•í˜• ì†ë°”ë‹¥. ìƒí™©ì— ë§ì¶° ì‹¤í–‰ê³¼ ì‚¬ê³ ë¥¼ ì¡°ìœ¨í•©ë‹ˆë‹¤.",
              "í˜‘ì—…Â·ì¡°ìœ¨ì— ê°•í•˜ê³ , ì¤‘ì¬ì í¬ì§€ì…˜ì— ì–´ìš¸ë¦½ë‹ˆë‹¤.",
            ] : [
              "Balanced palm. Coordinates action and thinking according to situation.",
              "Strong in collaboration and coordination, suits mediator position.",
            ],
          },
          head: {
            DEEP_THINKER: isKo ? [
              "ì§€ëŠ¥ì„ ì´ ê¸¸ê³  ì™„ë§Œí•œ íƒ€ì…. ê¹Šì´ ìƒê°í•˜ê³  í˜¼ìì„œë„ ê²°ì •ì„ ëê¹Œì§€ ë°€ì–´ë¶™ì…ë‹ˆë‹¤.",
              "ê¸°íš/ê¸€ì“°ê¸°/ì„¤ê³„ ìª½ì— ì˜ ë§ìœ¼ë©°, ìê¸° ê¸°ì¤€ì´ ëª…í™•í•©ë‹ˆë‹¤.",
            ] : [
              "Type with long and gentle intelligence line. Thinks deeply and pushes decisions alone.",
              "Fits planning/writing/design well, has clear self-standards.",
            ],
            REALIST: isKo ? [
              "í˜„ì‹¤ íŒë‹¨ì´ ë¹ ë¥¸ íƒ€ì…. ì‹¤í–‰ê³¼ íŒë‹¨ ì‚¬ì´ ê±°ë¦¬ê°€ ì§§ìŠµë‹ˆë‹¤.",
              "\"ìƒê°â†’ë°”ë¡œ í–‰ë™\" êµ¬ì¡°ë¼ ìŠ¤íƒ€íŠ¸ì—…í˜• ì—…ë¬´ì— ê°•í•©ë‹ˆë‹¤.",
            ] : [
              "Type with fast reality judgment. Short distance between action and judgment.",
              "Structure of 'thinkâ†’act immediately' works well for startup-type work.",
            ],
            FLEX_MAKER: isKo ? [
              "ì§ê´€ê³¼ í˜„ì‹¤ì„ ë²ˆê°ˆì•„ ì“°ëŠ” íƒ€ì…. ìƒí™©ì— ë”°ë¼ ì „ëµì„ ìœ ì—°í•˜ê²Œ ìˆ˜ì •í•©ë‹ˆë‹¤.",
              "ì‚¬ëŒÂ·ì¼ ì‚¬ì´ì˜ ê· í˜•ì„ ì˜ ì¡ì•„ì£¼ëŠ” ì¡°ìœ¨ìí˜•ì…ë‹ˆë‹¤.",
            ] : [
              "Type that alternates intuition and reality. Flexibly adjusts strategy according to situation.",
              "Coordinator type that balances people and work well.",
            ],
          },
          emotion: {
            STABLE_REALIST: isKo ? [
              "ê°ì •ì„ ì´ ì§ì„ í˜•. ê°ì • í‘œí˜„ì€ ë‹´ë°±í•˜ê³  ì‹ ë¢°/ì§€ì†ì„±ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤.",
              "ë“œë¼ë§ˆë³´ë‹¤ ì¼ìƒ ê³µìœ ë¥¼ ì„ í˜¸í•˜ë©°, ê°ì • ì†Œëª¨ í° ê´€ê³„ëŠ” ì˜¤ë˜ ê°€ì§€ ì•ŠìŠµë‹ˆë‹¤.",
            ] : [
              "Straight emotion line. Emotional expression is reserved, values trust/persistence.",
              "Prefers daily sharing over drama, emotionally draining relationships don't last long.",
            ],
            WARM_CURVE: isKo ? [
              "ì™„ë§Œí•œ ê³¡ì„ í˜•. ë°°ë ¤í˜•ì´ê³  ê´€ê³„ ì˜¨ë„ë¥¼ ë¶€ë“œëŸ½ê²Œ ìœ ì§€í•©ë‹ˆë‹¤.",
              "ì£¼ë³€ì„ í¸ì•ˆí•˜ê²Œ ë§Œë“œëŠ” í˜‘ì—…í˜• ê´€ê³„ ìŠ¤íƒ€ì¼ì…ë‹ˆë‹¤.",
            ] : [
              "Gentle curved type. Caring type that gently maintains relationship temperature.",
              "Collaborative relationship style that makes surroundings comfortable.",
            ],
            SPARK: isKo ? [
              "ì§§ê³  ìœ„ë¡œ ì¹˜ëŠ” ê°ì •ì„ . ì§§ê³  êµµê²Œ ëª°ì…í•˜ê³ , ì—´ì •ì´ ë¹ ë¥´ê²Œ ë¶™ìŠµë‹ˆë‹¤.",
              "ê°•í•œ ê°ì • ëª°ì… í›„ íœ´ì‹ì´ í•„ìš”í•œ í¸ì…ë‹ˆë‹¤.",
            ] : [
              "Short upward emotion line. Immerses short and intense, passion attaches quickly.",
              "Needs rest after strong emotional immersion.",
            ],
          },
          life: {
            STAMINA_STEADY: isKo ? [
              "ëŠê¹€ ì—†ëŠ” ìƒëª…ì„ . ì¥ê¸°ì „ì—ì„œ ê°•í•˜ê³  ê¾¸ì¤€í•¨ì´ ë¬´ê¸°ì…ë‹ˆë‹¤.",
              "ë¦¬ë“¬ë§Œ ìœ ì§€í•˜ë©´ ì•ˆì •ì ìœ¼ë¡œ ì„±ê³¼ë¥¼ ìŒ“ìŠµë‹ˆë‹¤.",
            ] : [
              "Unbroken life line. Strong in long-term, consistency is the weapon.",
              "Maintaining rhythm builds stable results.",
            ],
            BURSTY: isKo ? [
              "ì§§ê±°ë‚˜ ì–•ì€ ìƒëª…ì„ . ëª°ì…â†’íœ´ì‹ íŒ¨í„´ì´ ë°˜ë³µë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
              "ì§‘ì¤‘ íƒ€ì´ë°ì„ ì¡ì•„ ì§§ì€ ìŠ¤í”„ë¦°íŠ¸ë¥¼ ì„¤ê³„í•˜ë©´ ì„±ê³¼ê°€ ë‚©ë‹ˆë‹¤.",
            ] : [
              "Short or shallow life line. Immersionâ†’rest pattern may repeat.",
              "Designing short sprints at focus timing produces results.",
            ],
            RESILIENT: isKo ? [
              "ì„ ëª…í•˜ê³  ê¹Šì€ ìƒëª…ì„ . íšŒë³µë ¥ì´ ì¢‹ê³  ì²´ë ¥ ê¸°ë°˜ì´ íƒ„íƒ„í•©ë‹ˆë‹¤.",
              "ë§ì€ ì¼ì„ ë§¡ì•„ë„ ë²„í‹°ëŠ” í¸ì´ì§€ë§Œ, ê³¼ë„í•œ ê³¼ë¡œë§Œ í”¼í•˜ë©´ ë©ë‹ˆë‹¤.",
            ] : [
              "Clear and deep life line. Good recovery, solid stamina base.",
              "Can handle many tasks but should avoid excessive overwork.",
            ],
          },
        };
      }

      function classifyTypes(meta, measures) {
        const aspect = measures?.aspect || meta.aspect;
        const spread = measures?.spread || 0.65;
        const thumb = measures?.thumb || 0.32;
        const texture = meta.textureScore || 0.5;

        // FORM
        let form = "BALANCED";
        if (aspect > 1.05) form = "OPEN_WIDE";
        else if (aspect < 0.92) form = "OPEN_TALL";

        // HEAD (ì§€ëŠ¥ì„  ëŠë‚Œ): texture ë‚®ìœ¼ë©´ ì„  ëª…í™• â†’ REALIST, ë†’ìœ¼ë©´ DEEP_THINKER
        let head = "FLEX_MAKER";
        if (texture < 0.38) head = "REALIST";
        else if (texture > 0.48 || aspect < 0.95) head = "DEEP_THINKER";

        // EMOTION: ë°ê¸° ë‚®ê³  texture ë‚®ìœ¼ë©´ ë‹´ë°±, ë°ê³  texture ë†’ìœ¼ë©´ warm
        let emotion = "STABLE_REALIST";
        if (meta.brightness > 150 && texture > 0.45) emotion = "WARM_CURVE";
        if (meta.brightness < 115 && texture < 0.36) emotion = "SPARK";

        // LIFE: íŒŒì¼ í¬ê¸°ì™€ textureë¡œ ê¹Šì´ ì¶”ì •
        let life = "STAMINA_STEADY";
        if (meta.sizeKB < 600 && texture < 0.36) life = "BURSTY";
        if (meta.sizeKB > 1400 || texture > 0.52) life = "RESILIENT";

        // Adjust with spread/thumb: í° ë²Œì–´ì§ â†’ ë…ë¦½Â·ììœ¨ ê°•ì¡°
        if (spread > 0.7 || thumb > 0.36) {
          if (head === "FLEX_MAKER") head = "DEEP_THINKER";
        }

        return { form, head, emotion, life };
      }

      function buildInsightCards(types) {
        const tFunc = window.t || ((key) => key);
        const typeNames = getTypeNames();
        const typeCopy = getTypeCopy();
        const typeInsights = getTypeInsights();
        return [
          {
            tag: tFunc("tagForm"),
            code: typeNames[types.form],
            copy: typeCopy.form[types.form],
            lines: typeInsights.form[types.form],
          },
          {
            tag: tFunc("tagHead"),
            code: typeNames[types.head],
            copy: typeCopy.head[types.head],
            lines: typeInsights.head[types.head],
          },
          {
            tag: tFunc("tagEmotion"),
            code: typeNames[types.emotion],
            copy: typeCopy.emotion[types.emotion],
            lines: typeInsights.emotion[types.emotion],
          },
          {
            tag: tFunc("tagLife"),
            code: typeNames[types.life],
            copy: typeCopy.life[types.life],
            lines: typeInsights.life[types.life],
          },
        ];
      }

      function renderResult(meta, types, insights) {
        // Store for language switch re-render
        window.lastMeta = meta;
        window.lastTypes = types;
        window.lastInsights = insights;
        
        const tFunc = window.t || ((key) => key);
        const typeNames = getTypeNames();
        const typeCopy = getTypeCopy();
        const isKo = currentLang === "ko";
        
        metaChips.innerHTML = "";
        const ratioLabel = isKo ? "ë¹„ìœ¨" : "Ratio";
        const brightnessLabel = isKo ? "ë°ê¸°" : "Brightness";
        const fileLabel = isKo ? "íŒŒì¼" : "File";
        const textureLabel = isKo ? "ì§ˆê°" : "Texture";
        const chipData = [
          `${ratioLabel}: ${meta.aspect.toFixed(2)}:1`,
          `${brightnessLabel}: ${meta.brightness}`,
          `${fileLabel}: ${meta.sizeKB}KB`,
          `${textureLabel}: ${(meta.textureScore || 0).toFixed(2)}`,
        ];
        chipData.forEach((text) => {
          const chip = document.createElement("div");
          chip.className = "chip";
          chip.textContent = text;
          metaChips.appendChild(chip);
        });

        cards.innerHTML = "";
        insights.forEach((insight, idx) => {
          const el = document.createElement("div");
          el.className = "card";
          el.innerHTML = `
          <h3><span class="pill">${insight.tag}</span> ${insight.code}</h3>
          <p>${insight.copy}</p>
          <p>${insight.lines[0]}</p>
          <p>${insight.lines[1] || ""}</p>
        `;
          cards.appendChild(el);
        });

        // ì´í‰ ì¹´ë“œ ì¶”ê°€
        const summary = document.createElement("div");
        summary.className = "card";
        const summaryTag = tFunc("tagSummary");
        const summaryTitle = tFunc("summaryTitle");
        const summaryAction = tFunc("summaryAction");
        const oneLineLabel = isKo ? "í•œ ì¤„ë¡œ" : "In one line";
        summary.innerHTML = `
        <h3><span class="pill">${summaryTag}</span> ${summaryTitle}</h3>
        <p>${typeNames[types.form]} + ${typeNames[types.head]} + ${
          typeNames[types.emotion]
        } + ${typeNames[types.life]}</p>
        <p>${oneLineLabel}: ${typeCopy.head[types.head]
          .split("â†’")[0]
          .trim()} / ${typeCopy.emotion[types.emotion]
          .split("â†’")[0]
          .trim()} / ${typeCopy.life[types.life].split("â†’")[0].trim()}</p>
        <p>${summaryAction}</p>
      `;
        cards.appendChild(summary);
      }

      function setLoadingState(isLoading) {
        loading.classList.toggle("hidden", !isLoading);
        idleCopy.classList.toggle("hidden", isLoading);
        result.classList.add("hidden");
      }

      async function handleFile(file) {
        if (!file) return;
        await initHand(); // Ensure the model is loaded (or failed) before proceeding.
        const objectURL = URL.createObjectURL(file);
        preview.src = objectURL;
        previewArea.classList.remove("hidden");
        setLoadingState(true);

        let tick = 0;
        const interval = setInterval(() => {
          const states = getStates();
          const hints = getHints();
          loadingText.textContent = states[tick % states.length];
          loadingHint.textContent = hints[tick % hints.length];
          tick += 1;
        }, 700);

        const img = new Image();
        img.onload = async () => {
          // If the model failed to init, allow users to know and stop gracefully.
          if (!handLandmarker) {
            clearInterval(interval);
            setLoadingState(false);
            detectMsg.className = "alert";
            detectMsg.classList.remove("hidden");
            const tFunc = window.t || ((key) => key);
            detectMsg.textContent = tFunc("modelNotReady");
            return;
          }

          let handDetected = false;
          try {
            const detection = handLandmarker.detect(img);
            handDetected = Boolean(detection?.landmarks?.length);
            if (handDetected) lastLandmarks = detection.landmarks[0];
          } catch (err) {
            handDetected = false;
          }
          // Retry once with flipped image to help awkward angles.
          if (!handDetected) {
            const canvas = document.createElement("canvas");
            const ctx = canvas.getContext("2d");
            canvas.width = img.naturalWidth;
            canvas.height = img.naturalHeight;
            ctx.translate(canvas.width, 0);
            ctx.scale(-1, 1);
            ctx.drawImage(img, 0, 0);
            const flipped = new Image();
            flipped.src = canvas.toDataURL();
            await flipped.decode();
            try {
              const detection2 = handLandmarker.detect(flipped);
              handDetected = Boolean(detection2?.landmarks?.length);
              if (handDetected) lastLandmarks = detection2.landmarks[0];
            } catch (err) {
              handDetected = false;
            }
          }

          // Final fallback: allow palm-like textures even if fingers are partially missing.
          if (!handDetected) {
            handDetected = looksLikePalm(img);
          }

          const tFunc = window.t || ((key) => key);
          if (!handDetected) {
            clearInterval(interval);
            setLoadingState(false);
            detectMsg.className = "alert";
            detectMsg.classList.remove("hidden");
            detectMsg.textContent = tFunc("handNotDetected");
            return;
          }

          detectMsg.className = "alert ok";
          detectMsg.classList.remove("hidden");
          detectMsg.textContent = tFunc("handDetected");

          const meta = extractMeta(img, file);
          const measures = deriveMeasuresFromLandmarks(lastLandmarks, img);
          const types = classifyTypes(meta, measures);
          const insights = buildInsightCards(types);
          setTimeout(() => {
            clearInterval(interval);
            setLoadingState(false);
            renderResult(meta, types, insights);
            result.classList.remove("hidden");
            shareStatus.textContent = "";
            URL.revokeObjectURL(objectURL);
          }, 2100);
        };
        img.src = objectURL;
      }

      triggerUpload.addEventListener("click", () => input.click());
      input.addEventListener("change", (e) => handleFile(e.target.files[0]));

      dropZone.addEventListener("dragover", (e) => {
        e.preventDefault();
        dropZone.classList.add("dragover");
      });
      dropZone.addEventListener("dragleave", () =>
        dropZone.classList.remove("dragover")
      );
      dropZone.addEventListener("drop", (e) => {
        e.preventDefault();
        dropZone.classList.remove("dragover");
        handleFile(e.dataTransfer.files[0]);
      });

      shareBtn.addEventListener("click", async () => {
        const tFunc = window.t || ((key) => key);
        const text = tFunc("shareText");
        try {
          if (navigator.share) {
            await navigator.share({
              title: tFunc("shareTitle"),
              text,
              url: location.href,
            });
            shareStatus.textContent = tFunc("shareStatusShared");
          } else {
            await navigator.clipboard.writeText(location.href);
            shareStatus.textContent = tFunc("shareStatusCopied");
          }
        } catch (err) {
          shareStatus.textContent = tFunc("shareStatusCancelled");
        }
      });

      copyBtn.addEventListener("click", async () => {
        const tFunc = window.t || ((key) => key);
        try {
          await navigator.clipboard.writeText(location.href);
          shareStatus.textContent = tFunc("copyStatusCopied");
        } catch (err) {
          shareStatus.textContent = tFunc("copyStatusError");
        }
      });
    </script>
  
<ins class="adsbygoogle"
     style="display:block; text-align:center"
     data-ad-client="ca-pub-1204894220949193"
     data-ad-slot="5145068706"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
    
</body>
</html>
